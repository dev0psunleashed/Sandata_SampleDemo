SELECT DISTINCT T2.BE_PAR_ID,T1.BE_ID,T1.BE_NAME
  FROM BE T1
INNER JOIN BE_REL T2
ON T1.BE_ID = T2.BE_ID
  AND TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1
WHERE T2.BE_PAR_ID = '1'
  AND T2.BE_REL_TYP = 'BE_LOCATION'
  AND T2.BE_REL_STATUS = 'ACTIVE'
START WITH T2.BE_PAR_ID IS NULL
CONNECT BY NOCYCLE T2.BE_PAR_ID = PRIOR T1.BE_ID
ORDER BY BE_NAME;
