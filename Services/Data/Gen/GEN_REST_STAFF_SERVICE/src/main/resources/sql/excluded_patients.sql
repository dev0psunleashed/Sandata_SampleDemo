SELECT * FROM (SELECT ROWNUM ROW_NUMBER, COUNT(*) OVER() TOTAL_ROWS, R1.*
  FROM
   (SELECT DISTINCT
      T1.SCHED_PTC_EXCL_SK,T1.PATIENT_ID AS STAFF_EXCLUDED_PATIENT_ID,T2.PATIENT_SK,
      T1.STAFF_ID,T1.SCHED_PTC_EXCL_NOTE,
      T2.PATIENT_FIRST_NAME,T2.PATIENT_LAST_NAME,T2.PATIENT_MIDDLE_NAME,T1.PATIENT_ID,T1.SCHED_PTC_EXCL_TYPE
    FROM SCHED_PTC_EXCL T1
      INNER JOIN (SELECT PATIENT_SK,PATIENT_ID,PATIENT_FIRST_NAME,PATIENT_LAST_NAME,PATIENT_MIDDLE_NAME,
                   BSN_ENT_ID,REC_TERM_TMSTP,CURR_REC_IND
                 FROM PATIENT) T2
        ON T1.PATIENT_ID = T2.PATIENT_ID AND T1.BSN_ENT_ID = T2.BSN_ENT_ID

    WHERE T1.STAFF_ID = '3' AND T1.BSN_ENT_ID = '1' AND UPPER(SCHED_PTC_EXCL_TYPE) = 'EXCLUDE_PATIENT' AND
          (TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = '1') AND
          (TO_CHAR(T2.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T2.CURR_REC_IND = '1')
    ORDER BY T1.STAFF_ID DESC
   ) R1);
