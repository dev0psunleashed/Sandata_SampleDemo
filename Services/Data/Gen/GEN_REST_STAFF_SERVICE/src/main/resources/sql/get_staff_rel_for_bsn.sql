SELECT DISTINCT T2.STAFF_ID,T3.STAFF_FIRST_NAME,T3.STAFF_LAST_NAME,
          T2.STAFF_PARENT_ID,T1.STAFF_FIRST_NAME AS STAFF_PARENT_FIRST_NAME,
          T1.STAFF_LAST_NAME AS STAFF_PARENT_LAST_NAME,T2.STAFF_REL_TYPE,T2.STAFF_REL_SK
      FROM STAFF T1

  INNER JOIN (SELECT STAFF_ID,STAFF_PARENT_ID,STAFF_REL_TYPE,STAFF_REL_SK
      FROM STAFF_REL) T2
  ON T1.STAFF_ID = T2.STAFF_PARENT_ID

  INNER JOIN (SELECT STAFF_ID,STAFF_FIRST_NAME,STAFF_LAST_NAME,REC_TERM_TMSTP,CURR_REC_IND
      FROM STAFF) T3
  ON T2.STAFF_ID = T3.STAFF_ID

WHERE  T1.BSN_ENT_ID = '1'
          AND (TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1)
          AND (TO_CHAR(T3.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T3.CURR_REC_IND = 1)

ORDER BY UPPER(T1.STAFF_LAST_NAME) ASC;
