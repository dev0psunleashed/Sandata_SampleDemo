SELECT DISTINCT T1.BSN_ENT_ID,T1.BSN_ENT_PARENT_ID,T2.BSN_ENT_NAME,T2.BSN_ENT_FEDERALTAX_ID
  FROM BSN_ENT_REL T1
INNER JOIN (SELECT BSN_ENT_ID,BSN_ENT_NAME,BSN_ENT_FEDERALTAX_ID,REC_TERM_TMSTP,CURR_REC_IND FROM BSN_ENT) T2
ON T1.BSN_ENT_ID = T2.BSN_ENT_ID

WHERE T2.BSN_ENT_FEDERALTAX_ID IS NOT NULL
  AND (T1.BSN_ENT_PARENT_ID = '1' OR T1.BSN_ENT_ID = '1')

  -- NOTE: Created GEOR-3596 for Keith to see if the BSN_ENT_REL table is historical. Missing CURR_REC_IND column
  --AND (TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1)
  AND (TO_CHAR(T2.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T2.CURR_REC_IND = 1);
