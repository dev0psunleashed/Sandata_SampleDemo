SELECT * FROM (SELECT ROWNUM ROW_NUMBER, COUNT(*) OVER() TOTAL_ROWS, r1.*   
  FROM   
    (SELECT DISTINCT T1.INVOICE_SK,T1.INVOICE_PUBLISHED_DATE AS INVOICE_DATE,T1.INVOICE_TOTAL AS INVOICE_AMOUNT,   
          T4.PATIENT_FIRST_NAME,T4.PATIENT_LAST_NAME,T4.PATIENT_ID,T7.PAYER_NAME,            
          T8.TIMESHEET_WEEK_TOTAL_HRS AS INVOICE_HRS,T11.RATE_UNIT_NAME AS PAY_UNIT,  
          T9.CONTR_ID 
        FROM INVOICE T1       
      
      LEFT JOIN (SELECT INVOICE_SK,BSN_ENT_ID,TIMESHEET_DETL_SK,REC_TERM_TMSTP,CURR_REC_IND 
        FROM INVOICE_DETL) T2         
      ON T1.INVOICE_SK = T2.INVOICE_SK    
      
      LEFT JOIN (SELECT TIMESHEET_DETL_SK,TIMESHEET_SUMMARY_SK,PATIENT_ID,SERVICE_ACTIVITY_BILL_CODE_SK 
        FROM TIMESHEET_DETL) T3  
      ON T2.TIMESHEET_DETL_SK = T3.TIMESHEET_DETL_SK   
      
      LEFT JOIN (SELECT PATIENT_FIRST_NAME,PATIENT_LAST_NAME,PATIENT_ID,REC_TERM_TMSTP,CURR_REC_IND 
        FROM PATIENT) T4     
      ON T3.PATIENT_ID = T4.PATIENT_ID   
      
      LEFT JOIN (SELECT SERVICE_ACTIVITY_BILL_CODE_SK,ACTIVITY_SK 
        FROM SERVICE_ACTIVITY_BILL_CODE) T5      
      ON T3.SERVICE_ACTIVITY_BILL_CODE_SK = T5.SERVICE_ACTIVITY_BILL_CODE_SK   
      
      LEFT JOIN (SELECT ACTIVITY_SK,BSN_ENT_ID,PAYER_SK,ACTIVITY_BILLABLE_IND 
        FROM ACTIVITY) T6      
      ON T5.ACTIVITY_SK = T6.ACTIVITY_SK   
      
      LEFT JOIN (SELECT PAYER_SK,PAYER_NAME,PAYER_ID 
        FROM PAYER) T7      
      ON T6.PAYER_SK = T7.PAYER_SK   
      
      LEFT JOIN (SELECT TIMESHEET_SUMMARY_SK,TIMESHEET_WEEK_TOTAL_HRS 
        FROM TIMESHEET_SUMMARY) T8    
      ON T3.TIMESHEET_SUMMARY_SK = T8.TIMESHEET_SUMMARY_SK     
      
      LEFT JOIN (SELECT PAYER_SK,PAYER_CONTR_SK,CONTR_ID,BSN_ENT_ID 
        FROM PAYER_CONTR) T9     
      ON T7.PAYER_SK = T9.PAYER_SK  
      
      LEFT JOIN (SELECT PAYER_CONTR_SK,RATE_UNIT_LKUP_SK 
        FROM PAYER_RATE) T10   
      ON T9.PAYER_CONTR_SK = T10.PAYER_CONTR_SK     
      
      LEFT JOIN (SELECT RATE_UNIT_LKUP_SK,RATE_UNIT_NAME 
        FROM RATE_UNIT_LKUP) T11   
      ON T10.RATE_UNIT_LKUP_SK = T11.RATE_UNIT_LKUP_SK       
      
      LEFT JOIN (SELECT BSN_ENT_SK,BSN_ENT_ID 
        FROM BSN_ENT) BusinessEntity   
      ON T2.BSN_ENT_ID = T6.BSN_ENT_ID AND T6.BSN_ENT_ID = T9.BSN_ENT_ID  
      
      WHERE BusinessEntity.BSN_ENT_ID = '1' AND T6.ACTIVITY_BILLABLE_IND = 1 AND         
      
      T1.INVOICE_PUBLISHED_DATE BETWEEN TO_DATE('2015-11-25', 'YYYY-MM-DD') AND TO_DATE('2016-12-31', 'YYYY-MM-DD') AND 
      
      UPPER(T4.PATIENT_ID) LIKE '2222216803' AND 
      
      UPPER(T9.CONTR_ID) LIKE '1' AND         
      
      (TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1) AND       
      (TO_CHAR(T2.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T2.CURR_REC_IND = 1) AND      
      (TO_CHAR(T4.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T4.CURR_REC_IND = 1)   
      
      ORDER BY UPPER(T4.PATIENT_LAST_NAME) DESC     ) r1)WHERE ROW_NUMBER BETWEEN 1 AND 10;