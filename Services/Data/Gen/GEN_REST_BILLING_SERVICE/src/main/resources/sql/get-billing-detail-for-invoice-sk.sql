SELECT DISTINCT T1.INVOICE_SK,T1.INVOICE_ID,T1.INVOICE_PUBLISHED_DATE AS INVOICE_DATE,T1.INVOICE_TOTAL AS INVOICE_AMOUNT,
    T4.PT_FIRST_NAME,T4.PT_LAST_NAME,T4.PT_ID,T7.PAYER_NAME,T4.PT_DOB, T8.STAFF_ID,
    T8.TIMESHEET_WEEK_TOTAL_HRS AS INVOICE_HRS,T11.SVC_UNIT_NAME AS PAY_UNIT, T3.VISIT_SK,T9.CONTR_ID,

    (SELECT ADMIN_STAFF_ID FROM ADMIN_STAFF_REL WHERE UPPER(ADMIN_STAFF_REL.ADMIN_STAFF_REL_TYP_NAME) = 'COORDINATOR' AND ADMIN_STAFF_REL.ADMIN_STAFF_REL_SK=1) AS STAFF_COORDINATOR_ID,

    T12.SVC_NAME,T1.BILLING_TYP AS BILLING_FREQUENCY,

    T14.PAYER_RATE_MDFR_CODE,T13.BE_PRMY_ADDR1,T13.BE_PRMY_ADDR2,T13.BE_PRMY_CITY,T13.BE_PRMY_STATE,T13.BE_PRMY_ZIP4,T6.ACTIVITY_BILLABLE_IND

    FROM INVOICE T1

    RIGHT JOIN (SELECT INVOICE_SK,BE_ID,TIMESHEET_DET_SK,REC_TERM_TMSTP,CURR_REC_IND
      FROM INVOICE_DET) T2
    ON T1.INVOICE_SK = T2.INVOICE_SK

    LEFT JOIN (SELECT TIMESHEET_DET_SK,TIMESHEET_SUMMARY_SK,PT_ID,SVC_ACTIVITY_BILLING_CODE_SK,VISIT_SK
      FROM TIMESHEET_DET) T3
    ON T2.TIMESHEET_DET_SK = T3.TIMESHEET_DET_SK

    LEFT JOIN (SELECT PT_ID,PT_FIRST_NAME,PT_LAST_NAME,PT_DOB,REC_TERM_TMSTP,CURR_REC_IND
      FROM PT) T4
    ON T3.PT_ID = T4.PT_ID

    LEFT JOIN (SELECT SVC_ACTIVITY_BILLING_CODE_SK,ACTIVITY_SK,SVC_NAME
      FROM SVC_ACTIVITY_BILLING_CODE) T5
    ON T3.SVC_ACTIVITY_BILLING_CODE_SK = T5.SVC_ACTIVITY_BILLING_CODE_SK

    LEFT JOIN (SELECT ACTIVITY_SK,BE_ID,PAYER_SK,ACTIVITY_BILLABLE_IND
      FROM ACTIVITY) T6
    ON T5.ACTIVITY_SK = T6.ACTIVITY_SK

    LEFT JOIN (SELECT PAYER_SK,PAYER_NAME,PAYER_ID
      FROM PAYER) T7
    ON T6.PAYER_SK = T7.PAYER_SK

    LEFT JOIN (SELECT TIMESHEET_SUMMARY_SK,TIMESHEET_WEEK_TOTAL_HRS,STAFF_ID
      FROM TIMESHEET_SUMMARY) T8
    ON T3.TIMESHEET_SUMMARY_SK = T8.TIMESHEET_SUMMARY_SK

    LEFT JOIN (SELECT STAFF_SK,STAFF_ID
      FROM STAFF) T8_STAFF
    ON T8_STAFF.STAFF_ID = T8.STAFF_ID

    LEFT JOIN (SELECT PAYER_ID,CONTR_SK,CONTR_ID,BE_ID
      FROM CONTR) T9
    ON T7.PAYER_ID = T9.PAYER_ID

    LEFT JOIN (SELECT CONTR_ID,SVC_UNIT_NAME
      FROM CONTR_RATE) T10
    ON T9.CONTR_ID = T10.CONTR_ID

    LEFT JOIN (SELECT SVC_UNIT_LKUP_SK,SVC_UNIT_NAME
      FROM SVC_UNIT_LKUP) T11
    ON T10.SVC_UNIT_NAME = T11.SVC_UNIT_NAME

    LEFT JOIN (SELECT SVC_SK,SVC_NAME,BE_ID
      FROM SVC) T12
    ON T5.SVC_NAME = T12.SVC_NAME

    LEFT JOIN (SELECT BE_ID,BE_SK,BE_PRMY_ADDR1,BE_PRMY_ADDR2,BE_PRMY_CITY,BE_PRMY_STATE,BE_PRMY_ZIP4,REC_TERM_TMSTP,CURR_REC_IND
      FROM BE) T13
    ON T2.BE_ID = T6.BE_ID AND T6.BE_ID = T9.BE_ID

    LEFT JOIN (SELECT CONTR_ID,PAYER_RATE_MDFR_CODE
      FROM PAYER_RATE_MDFR) T14
    ON T9.CONTR_ID = T14.CONTR_ID

    WHERE T13.BE_ID = '1' AND T1.INVOICE_SK = 1281
      AND (TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1)
      AND (TO_CHAR(T2.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T2.CURR_REC_IND = 1)
      AND (TO_CHAR(T4.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T4.CURR_REC_IND = 1)
      AND (TO_CHAR(T13.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T13.CURR_REC_IND = 1)

ORDER BY T4.PT_LAST_NAME ASC;
