CREATE OR REPLACE PACKAGE PKG_BSN_UTIL IS

  FUNCTION DELETE_BE_RATE(v_be_id IN BE_RATE.BE_ID%TYPE, v_svc_name IN BE_RATE.SVC_NAME%TYPE, v_rate_type_name IN BE_RATE.RATE_TYP_NAME%TYPE) RETURN NUMBER;

END PKG_BSN_UTIL;
/

CREATE OR REPLACE PACKAGE BODY PKG_BSN_UTIL IS

  FUNCTION DELETE_BE_RATE(v_be_id IN BE_RATE.BE_ID%TYPE, v_svc_name IN BE_RATE.SVC_NAME%TYPE, v_rate_type_name IN BE_RATE.RATE_TYP_NAME%TYPE) RETURN NUMBER
  AS
  BEGIN
    
    UPDATE BE_RATE
    SET
      REC_TERM_TMSTP=TO_DATE(SYSDATE, 'YYYY-MM-DD'),
      CURR_REC_IND = 0
    WHERE
      BE_ID = v_be_id
      AND SVC_NAME = v_svc_name
      AND UPPER(RATE_TYP_NAME) = v_rate_type_name
      AND RATE_QLFR_CODE = 'PAY'
      AND (TO_CHAR(REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND CURR_REC_IND = 1);
    
    RETURN SQL%ROWCOUNT;
    
  END DELETE_BE_RATE;

END PKG_BSN_UTIL;
/
