SELECT * FROM BE_LOB_LKUP
WHERE BE_ID = '1-BE_LOB-FIDA';

SELECT * FROM BE
WHERE BE_ID = '1-BE_LOB-FIDA'
  AND TO_CHAR(REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND CURR_REC_IND = 1;

SELECT * FROM BE_REL
WHERE BE_ID = '1-BE_LOB-FIDA'
  AND BE_PAR_ID = '1'
  AND BE_REL_TYP = 'BE_LOB'
  AND BE_REL_STATUS = 'ACTIVE';


SELECT 1 FROM (
SELECT DISTINCT T2.BE_PAR_ID,T1.BE_ID
  FROM BE T1
INNER JOIN BE_REL T2
ON T1.BE_ID = T2.BE_ID
WHERE T2.BE_PAR_ID = '1'
  AND T1.BE_ID = '1-BE_LOB-FIDA'
  AND T2.BE_REL_TYP = 'BE_LOB'
  AND T2.BE_REL_STATUS = 'ACTIVE'
START WITH T2.BE_PAR_ID IS NULL
CONNECT BY NOCYCLE T2.BE_PAR_ID = PRIOR T1.BE_ID);
--ORDER SIBLINGS BY T2.BE_PAR_ID) B1;

SELECT 1 FROM (
SELECT DISTINCT T2.BE_PAR_ID,T1.BE_ID,T1.BE_NAME
  FROM BE T1
INNER JOIN BE_REL T2
ON T1.BE_ID = T2.BE_ID
  AND TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1
WHERE T2.BE_PAR_ID = '1'
  AND T2.BE_REL_TYP = 'BE_LOB'
  AND T2.BE_REL_STATUS = 'ACTIVE'
  AND UPPER(T1.BE_NAME) = 'FIDA'
START WITH T2.BE_PAR_ID IS NULL
CONNECT BY NOCYCLE T2.BE_PAR_ID = PRIOR T1.BE_ID);

-- Does an agency parent exists in BE_REL?
SELECT 1 FROM (
SELECT T1.BE_ID,T1.BE_PAR_ID
FROM BE_REL T1
WHERE T1.BE_ID = '1'
  AND T1.BE_PAR_ID IS NULL);

-- Get LOB for given Agency
SELECT * FROM (
  SELECT DISTINCT
        T2.BE_PAR_ID,
        T1.BE_ID AS C_BE_ID,
        T1.BE_NAME AS C_BE_NAME
  FROM BE T1
  INNER JOIN BE_REL T2
  ON T1.BE_ID = T2.BE_ID
    AND TO_CHAR(T1.REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND T1.CURR_REC_IND = 1
  START WITH T2.BE_PAR_ID IS NULL
  CONNECT BY NOCYCLE T2.BE_PAR_ID = PRIOR T1.BE_ID)
INNER JOIN BE_LOB_LKUP
ON BE_LOB_LKUP.BE_ID = C_BE_ID AND BE_LOB_LKUP.BE_LOB = C_BE_NAME
WHERE BE_PAR_ID = '1'
ORDER BY C_BE_NAME ASC;

-- GET SK VALUES
SELECT BE_ID FROM BE_LOB_LKUP WHERE BE_LOB_LKUP_SK = 136;
SELECT BE_SK FROM BE WHERE BE_ID = '5d705fca-74f6-4cf7-942d-d10aa555bb0e';
SELECT BE_REL_SK FROM BE_REL WHERE BE_ID = '5d705fca-74f6-4cf7-942d-d10aa555bb0e';

commit;
