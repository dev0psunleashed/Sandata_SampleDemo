CREATE OR REPLACE PACKAGE PKG_DOCXWALK_UTIL IS

  FUNCTION DELETE_DOC_XWALK(v_table_name IN VARCHAR2, v_colum_name IN VARCHAR2, v_value IN VARCHAR2) RETURN NUMBER;

END PKG_DOCXWALK_UTIL;
/

CREATE OR REPLACE PACKAGE BODY PKG_DOCXWALK_UTIL IS

  FUNCTION DELETE_DOC_XWALK(v_table_name IN VARCHAR2, v_colum_name IN VARCHAR2, v_value IN VARCHAR2) RETURN NUMBER
  AS
    v_sql VARCHAR2(1024);
  BEGIN

    v_sql := 'UPDATE ' || v_table_name || ' SET CURR_REC_IND = 0, REC_TERM_TMSTP = CURRENT_DATE';
    v_sql := v_sql || ' WHERE ' || v_colum_name || ' = :v_value AND CURR_REC_IND = 1';
    EXECUTE IMMEDIATE v_sql USING v_value;

    RETURN SQL%ROWCOUNT;

  END DELETE_DOC_XWALK;

END PKG_DOCXWALK_UTIL;
/
