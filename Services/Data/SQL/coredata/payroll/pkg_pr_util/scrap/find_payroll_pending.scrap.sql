SELECT * FROM (SELECT ROWNUM ROW_NUMBER, COUNT(*) OVER() TOTAL_ROWS, R1.* FROM (

  SELECT * FROM (

      (SELECT DISTINCT
              T1.TIMESHEET_SUMMARY_SK,
              T1.STAFF_ID,
              T2.STAFF_FIRST_NAME,
              T2.STAFF_LAST_NAME,
              T1.TIMESHEET_WEEK_TOTAL_HRS,
              T1.TIMESHEET_WEEK_END_DATE,
              T4.CHECK_NUM,
              T4.CHECK_DATE,
              T4.GROSS_PAY_AMT

        FROM TIMESHEET_SUMMARY T1

        INNER JOIN (SELECT BE_ID,STAFF_ID,STAFF_FIRST_NAME,STAFF_LAST_NAME
          FROM STAFF
            WHERE (TO_CHAR(REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND CURR_REC_IND = 1)) T2
        ON T1.BE_ID = T2.BE_ID AND T1.STAFF_ID = T2.STAFF_ID

        LEFT JOIN (SELECT TIMESHEET_SUMMARY_SK,INTF_ID,STAFF_ID,BE_LOB_ID,BE_ID
          FROM PR_OUTPUT
            WHERE (TO_CHAR(REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND CURR_REC_IND = 1)) T3
        ON T1.TIMESHEET_SUMMARY_SK = T3.TIMESHEET_SUMMARY_SK

        LEFT JOIN (SELECT INTF_ID,STAFF_ID,BE_ID,WEEK_END_DATE,CHECK_NUM,CHECK_DATE,GROSS_PAY_AMT,EFT_TXN_ID
          FROM PR_INPUT
            WHERE (TO_CHAR(REC_TERM_TMSTP, 'YYYY-MM-DD') = '9999-12-31' AND CURR_REC_IND = 1)) T4
        ON T3.BE_ID = T4.BE_ID AND T3.INTF_ID = T4.INTF_ID AND T3.STAFF_ID = T4.STAFF_ID
          AND T4.WEEK_END_DATE = T1.TIMESHEET_WEEK_END_DATE

        WHERE (T1.TIMESHEET_WEEK_END_DATE IS NOT NULL
                -- ONLY RETURN RECORDS THAT HAVE TIMESHEET_DET ENTRIES (EXCLUDE BAD DATA)
                AND EXISTS (SELECT 1 FROM TIMESHEET_DET WHERE TIMESHEET_DET.TIMESHEET_SUMMARY_SK = T1.TIMESHEET_SUMMARY_SK))
        ORDER BY STAFF_LAST_NAME DESC)
  )

) R1)

WHERE ROW_NUMBER BETWEEN 1 AND 10;
