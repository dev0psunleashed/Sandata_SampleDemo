<!DOCTYPE html>
<html>
<head>
  <title>AuthenticationService.java</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../../../../../../coverage.css'/>
  <link rel='shortcut icon' type='image/png' href='../../../../../../logo.png'/>
  <script type='text/javascript' src='../../../../../../coverage.js'></script>
  <script type='text/javascript' src='../../../../../../prettify.js'></script>
</head>
<body onload='prettyPrint()'>
  <table cellpadding='0' cellspacing='1'>
    <caption>Authentication Service\src\main\java\com\sandata\lab\security\auth\impl\AuthenticationService.java</caption>
    <tr>
      <td class='line'>1</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>package com.sandata.lab.security.auth.impl;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'></td><td>&nbsp;</td>
      <td><pre class='imports prettyprint' onclick='showHideLines(this)'><div>import com.sandata.lab.common.utils.exception.SandataRuntimeException;
import com.sandata.lab.common.utils.log.SandataLogger;
import com.sandata.lab.common.utils.string.StringUtil;
import com.sandata.lab.data.model.dl.model.ApplicationModule;
import com.sandata.lab.data.model.dl.model.ApplicationSecureGroup;
import com.sandata.lab.data.model.dl.model.ApplicationUser;
import com.sandata.lab.data.model.dl.model.extended.ApplicationRoleExt;
import com.sandata.lab.data.model.dl.model.extended.ApplicationUserExt;
import com.sandata.lab.data.model.response.Response;
import com.sandata.lab.data.model.service.ServiceStatus;
import com.sandata.lab.security.auth.model.Email;
import com.sandata.lab.security.auth.model.forgeRock.AccessToken;
import com.sandata.lab.security.auth.model.forgeRock.User;
import com.sandata.lab.security.auth.services.IDMService;
import com.sandata.lab.security.auth.services.OpenAMService;
import com.sandata.lab.security.auth.utils.log.AuthenticationLogger;
import org.apache.camel.Exchange;
import org.apache.camel.PropertyInject;
import org.apache.commons.codec.binary.Base64;
import org.apache.commons.lang3.RandomStringUtils;
import org.apache.cxf.message.MessageContentsList;
import org.dozer.DozerBeanMapper;

import java.nio.charset.StandardCharsets;
import java.security.SecureRandom;
import java.util.*;
</div><span>import ...</span></pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>30</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l30s0'>public class AuthenticationService {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>32</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l32s0'>    @PropertyInject("{{min.password.length}}")</pre></td>
    </tr>
    <tr>
      <td class='line'>33</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private int minPassWordLength = 5;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>35</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l35s0'>    @PropertyInject("{{max.password.length}}")</pre></td>
    </tr>
    <tr>
      <td class='line'>36</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private int maxPasswordLength = 10;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>38</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private IDMService idmService;</pre></td>
    </tr>
    <tr>
      <td class='line'>39</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private OpenAMService openAMService;</pre></td>
    </tr>
    <tr>
      <td class='line'>40</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private RestDataService restDataService;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>42</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void setRestDataService(RestDataService restDataService) {</pre></td>
    </tr>
    <tr>
      <td class='line'>43</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l43s0'>        this.restDataService = restDataService;</pre></td>
    </tr>
    <tr>
      <td class='line'>44</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l44s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>46</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void setOpenAMService(OpenAMService openAMService) {</pre></td>
    </tr>
    <tr>
      <td class='line'>47</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l47s0'>        this.openAMService = openAMService;</pre></td>
    </tr>
    <tr>
      <td class='line'>48</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l48s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>50</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void setIdmService(IDMService idmService) {</pre></td>
    </tr>
    <tr>
      <td class='line'>51</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l51s0'>        this.idmService = idmService;</pre></td>
    </tr>
    <tr>
      <td class='line'>52</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l52s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>55</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void createUser(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>57</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l57s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>59</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>61</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l61s0'>            ApplicationUserExt applicationUserExt = (ApplicationUserExt) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>64</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l64s0'>            int result = 0;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>66</td><td>&nbsp;</td>
      <td><pre class='comment'>            //Does user already exist</pre></td>
    </tr>
    <tr>
      <td class='line'>67</td><td>&nbsp;</td>
      <td><pre class='comment'>            //User may already exist and be associated with another entity</pre></td>
    </tr>
    <tr>
      <td class='line'>68</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l68s0'>            User existingUser = idmService.getUser(applicationUserExt.getUserName());</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>70</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l70s0'>            String existingGUID = null;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>72</td><td class='count'>1</td>
      <td><pre class='prettyprint jmp'>            <span id='l72s0' title='Executions: 1' class='covered'>if (existingUser != null)</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>74</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l74s0'>                existingGUID = existingUser.getSandataGUID();</pre></td>
    </tr>
    <tr>
      <td class='line'>75</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>77</td><td class='count'>1</td>
      <td><pre class='prettyprint jmp'>            <span id='l77s0' title='Executions: 1' class='covered'>if (StringUtil.IsNullOrEmpty(existingGUID))</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>79</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l79s0'>                String userGUID = generateGUID();</pre></td>
    </tr>
    <tr>
      <td class='line'>80</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l80s0'>                applicationUserExt.setUserGloballyUniqueIdentifier(userGUID);</pre></td>
    </tr>
    <tr>
      <td class='line'>81</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l81s0'>            } else {</pre></td>
    </tr>
    <tr>
      <td class='line'>82</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l82s0'>                applicationUserExt.setUserGloballyUniqueIdentifier(existingGUID);</pre></td>
    </tr>
    <tr>
      <td class='line'>83</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>86</td><td>&nbsp;</td>
      <td><pre class='comment'>            //Create new User instance and map ApplicationUserExt</pre></td>
    </tr>
    <tr>
      <td class='line'>87</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l87s0'>            DozerBeanMapper mapper = new DozerBeanMapper(Arrays.asList(new String[]{"dozer/userMapping.xml"}));</pre></td>
    </tr>
    <tr>
      <td class='line'>88</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l88s0'>            User user = (User) mapper.map(applicationUserExt, User.class);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>90</td><td class='count'>1</td>
      <td><pre class='prettyprint jmp'>            <span id='l90s0' title='Executions: 1' class='covered'>if (existingUser == null)</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>92</td><td>&nbsp;</td>
      <td><pre class='comment'>                //Generate a temp password for the new user</pre></td>
    </tr>
    <tr>
      <td class='line'>93</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l93s0'>                String password = newPassword();</pre></td>
    </tr>
    <tr>
      <td class='line'>94</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l94s0'>                user.setPassword(password);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>96</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l96s0'>                user.setSandataAccess("YES");</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>98</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l98s0'>                User createdUser = idmService.createUser(user);</pre></td>
    </tr>
    <tr>
      <td class='line'>99</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l99s0'>                logger.info(String.format("Successfully created user with username: %s", user.getUserName()));</pre></td>
    </tr>
    <tr>
      <td class='line'>100</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l100s0'>                result = restDataService.insertUser(applicationUserExt);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>102</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l102s0'>                String from = "no-reply@sandata.com";</pre></td>
    </tr>
    <tr>
      <td class='line'>103</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l103s0'>                String message = "Your temporary password is " + password + ". Please login and change, 8 char min length one capital and one number required.";</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>105</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l105s0'>                idmService.emailUser(user.getEmail(), from, "text/html", "Password Reset", message);</pre></td>
    </tr>
    <tr>
      <td class='line'>106</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l106s0'>                logger.info(String.format("Successfully sent email user to user: %s", user.getUserName()));</pre></td>
    </tr>
    <tr>
      <td class='line'>107</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l107s0'>            } else {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>109</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l109s0'>                idmService.updateUser(user);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>111</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l111s0'>                ApplicationUser metaUser = restDataService.getApplicationUserByUserName(applicationUserExt.getUserName());</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>114</td><td class='count'>1</td>
      <td><pre class='prettyprint jmp'>                <span id='l114s0' title='Executions: 1' class='covered'>if (metaUser == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>115</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l115s0'>                    result = restDataService.insertUser(applicationUserExt);</pre></td>
    </tr>
    <tr>
      <td class='line'>116</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                } else {</pre></td>
    </tr>
    <tr>
      <td class='line'>117</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l117s0'>                    restDataService.updateUser(applicationUserExt);</pre></td>
    </tr>
    <tr>
      <td class='line'>118</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l118s0'>                    result = applicationUserExt.getApplicationUserSK().intValue();</pre></td>
    </tr>
    <tr>
      <td class='line'>119</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>121</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l121s0'>                logger.info(String.format("Successfully updated user with username: %s", user.getUserName()));</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>123</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>126</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l126s0'>            exchange.getIn().setBody(result);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>129</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l129s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>130</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l130s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>131</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l131s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>132</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        } finally {</pre></td>
    </tr>
    <tr>
      <td class='line'>133</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l133s0'>            logger.stop();</pre></td>
    </tr>
    <tr>
      <td class='line'>134</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l134s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>135</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l135s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>137</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void deleteRole(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr>
      <td class='line'>138</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l138s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>140</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>142</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l142s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>145</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l145s0'>            int appRoleSk = (int) mcl.get(0);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>148</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l148s0'>            int result = restDataService.deleteRole(appRoleSk);</pre></td>
    </tr>
    <tr>
      <td class='line'>149</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l149s0'>            result = 1;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>151</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l151s0'>            exchange.getIn().setBody(result);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>153</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l153s0'>            logger.info(String.format("Successfully deleted role with roleSK: %d", appRoleSk));</pre></td>
    </tr>
    <tr>
      <td class='line'>154</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l154s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>155</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l155s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>156</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l156s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>157</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l157s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>158</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l158s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>160</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void getUser(Exchange exchange) {</pre></td>
    </tr>
    <tr>
      <td class='line'>161</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l161s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>163</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr>
      <td class='line'>164</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l164s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr>
      <td class='line'>165</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l165s0'>            String businessEntityId = (String) mcl.get(1);</pre></td>
    </tr>
    <tr>
      <td class='line'>166</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l166s0' title='Executions: 0' class='uncovered'>if (businessEntityId == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>167</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l167s0'>                throw new SandataRuntimeException("BusinessEntityID (bsn_ent_id) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>168</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>170</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l170s0'>            String userName = (String) mcl.get(0);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>172</td><td>&nbsp;</td>
      <td><pre class='comment'>            //Retrieve user from ForgeRock</pre></td>
    </tr>
    <tr>
      <td class='line'>173</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l173s0'>            User user = idmService.getUser(userName);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>176</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l176s0' title='Executions: 0' class='uncovered'>if (user != null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>177</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l177s0'>                DozerBeanMapper mapper = new DozerBeanMapper(Arrays.asList(new String[]{"dozer/userMapping.xml"}));</pre></td>
    </tr>
    <tr>
      <td class='line'>178</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l178s0'>                ApplicationUserExt applicationUserExt = (ApplicationUserExt) mapper.map(user, ApplicationUserExt.class);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>180</td><td>&nbsp;</td>
      <td><pre class='comment'>                //Retrieve same user from metadata that corresponds with business entity</pre></td>
    </tr>
    <tr>
      <td class='line'>181</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l181s0'>                ApplicationUserExt metaApplicationUserExt = restDataService.getApplicationUserByUserName(userName, businessEntityId);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>183</td><td>&nbsp;</td>
      <td><pre class='comment'>                //If the user is not found in metadata, then the user does not exis for the business entity id</pre></td>
    </tr>
    <tr>
      <td class='line'>184</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>                <span id='l184s0' title='Executions: 0' class='uncovered'>if (metaApplicationUserExt == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>185</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l185s0'>                    exchange.getIn().setBody(null);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>187</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l187s0'>                    return;</pre></td>
    </tr>
    <tr>
      <td class='line'>188</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>190</td><td>&nbsp;</td>
      <td><pre class='comment'>                //Merge the data from both sources</pre></td>
    </tr>
    <tr>
      <td class='line'>191</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l191s0'>                applicationUserExt.getApplicationUserRole().addAll(metaApplicationUserExt.getApplicationUserRole());</pre></td>
    </tr>
    <tr>
      <td class='line'>192</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l192s0'>                applicationUserExt.getApplicationUserSetting().addAll(metaApplicationUserExt.getApplicationUserSetting());</pre></td>
    </tr>
    <tr>
      <td class='line'>193</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l193s0'>                applicationUserExt.setUserGloballyUniqueIdentifier(metaApplicationUserExt.getUserGloballyUniqueIdentifier());</pre></td>
    </tr>
    <tr>
      <td class='line'>194</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l194s0'>                applicationUserExt.setUserMiddleName(metaApplicationUserExt.getUserMiddleName());</pre></td>
    </tr>
    <tr>
      <td class='line'>195</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l195s0'>                applicationUserExt.setApplicationUserSK(metaApplicationUserExt.getApplicationUserSK());</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>197</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l197s0'>                exchange.getIn().setBody(applicationUserExt);</pre></td>
    </tr>
    <tr>
      <td class='line'>198</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l198s0'>            } else {</pre></td>
    </tr>
    <tr>
      <td class='line'>199</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l199s0'>                exchange.getIn().setBody(null);</pre></td>
    </tr>
    <tr>
      <td class='line'>200</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr>
      <td class='line'>201</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l201s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>203</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l203s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>204</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l204s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>205</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l205s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>206</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l206s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>208</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void userExistsForBsnEntId(Exchange exchange) {</pre></td>
    </tr>
    <tr>
      <td class='line'>209</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l209s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>211</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr>
      <td class='line'>212</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l212s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr>
      <td class='line'>213</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l213s0'>            String businessEntityId = (String) mcl.get(1);</pre></td>
    </tr>
    <tr>
      <td class='line'>214</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l214s0' title='Executions: 0' class='uncovered'>if (businessEntityId == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>215</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l215s0'>                throw new SandataRuntimeException("BusinessEntityID (bsn_ent_id) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>216</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>218</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l218s0'>            String userName = (String) mcl.get(0);</pre></td>
    </tr>
    <tr>
      <td class='line'>219</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l219s0' title='Executions: 0' class='uncovered'>if (userName == null</span></pre></td>
    </tr>
    <tr>
      <td class='line'>220</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                || userName.isEmpty()) {</pre></td>
    </tr>
    <tr>
      <td class='line'>221</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l221s0'>                throw new SandataRuntimeException("User name (username) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>222</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>224</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l224s0'>            boolean userExists = false;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>226</td><td>&nbsp;</td>
      <td><pre class='comment'>            //Retrieve user from ForgeRock</pre></td>
    </tr>
    <tr>
      <td class='line'>227</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l227s0'>            User user = idmService.getUser(userName);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>229</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l229s0' title='Executions: 0' class='uncovered'>if (user != null)</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>231</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l231s0'>                userExists = restDataService.isApplicationUserExists(userName, businessEntityId);</pre></td>
    </tr>
    <tr>
      <td class='line'>232</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>234</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l234s0'>            exchange.getIn().setBody(userExists);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>236</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l236s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>238</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l238s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>239</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l239s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>240</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l240s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>241</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l241s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>243</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void userExists(Exchange exchange) {</pre></td>
    </tr>
    <tr>
      <td class='line'>244</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l244s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>246</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr>
      <td class='line'>247</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l247s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr>
      <td class='line'>248</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l248s0'>            String userName = (String) mcl.get(0);</pre></td>
    </tr>
    <tr>
      <td class='line'>249</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l249s0' title='Executions: 0' class='uncovered'>if (userName == null</span></pre></td>
    </tr>
    <tr>
      <td class='line'>250</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                || userName.isEmpty()) {</pre></td>
    </tr>
    <tr>
      <td class='line'>251</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l251s0'>                throw new SandataRuntimeException("User name (username) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>252</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>254</td><td>&nbsp;</td>
      <td><pre class='comment'>            //Retrieve user from ForgeRock</pre></td>
    </tr>
    <tr>
      <td class='line'>255</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l255s0'>            User user = idmService.getUser(userName);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>257</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l257s0' title='Executions: 0' class='uncovered'>exchange.getIn().setBody(user != null);</span></pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>259</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l259s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>261</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l261s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>262</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l262s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>263</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l263s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>264</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l264s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>266</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void updateUser(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>268</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l268s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>270</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>272</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l272s0'>            ApplicationUserExt applicationUserExt = (ApplicationUserExt) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>274</td><td>&nbsp;</td>
      <td><pre class='comment'>            //Create new User instance and map ApplicationUserExt</pre></td>
    </tr>
    <tr>
      <td class='line'>275</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l275s0'>            DozerBeanMapper mapper = new DozerBeanMapper(Arrays.asList(new String[]{"dozer/userMapping.xml"}));</pre></td>
    </tr>
    <tr>
      <td class='line'>276</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l276s0'>            User user = (User) mapper.map(applicationUserExt, User.class);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>278</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l278s0'>            idmService.updateUser(user);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>280</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l280s0'>            int result = restDataService.updateUser(applicationUserExt);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>282</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l282s0'>            result = 1;</pre></td>
    </tr>
    <tr>
      <td class='line'>283</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l283s0'>            exchange.getIn().setBody(result);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>285</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l285s0'>            logger.info(String.format("Successfully updated user with username: %s", user.getUserName()));</pre></td>
    </tr>
    <tr>
      <td class='line'>286</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l286s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>287</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l287s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>288</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l288s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>289</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        } finally {</pre></td>
    </tr>
    <tr>
      <td class='line'>290</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l290s0'>            logger.stop();</pre></td>
    </tr>
    <tr>
      <td class='line'>291</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l291s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>292</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l292s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>294</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void deleteUser(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>296</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l296s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>298</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>300</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l300s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>303</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l303s0'>            int userSk = (int) mcl.get(0);</pre></td>
    </tr>
    <tr>
      <td class='line'>304</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l304s0'>            String businessEntityId = (String) mcl.get(1);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>306</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l306s0' title='Executions: 0' class='uncovered'>if (businessEntityId == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>307</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l307s0'>                throw new SandataRuntimeException("BusinessEntityID (bsn_ent_id) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>308</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>310</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l310s0'>            int result = restDataService.deleteUserFromTenant(businessEntityId, userSk);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>312</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l312s0'>            exchange.getIn().setBody(null);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>314</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l314s0'>            logger.info(String.format("Successfully deleted user with userSK: %d for businessEntityID: %s", userSk, businessEntityId));</pre></td>
    </tr>
    <tr>
      <td class='line'>315</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l315s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>316</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l316s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>317</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l317s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>318</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l318s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>319</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l319s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>321</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void findUser(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>323</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l323s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>325</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>327</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l327s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr>
      <td class='line'>328</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l328s0'>            String bsnEntId = (String) mcl.get(8);</pre></td>
    </tr>
    <tr>
      <td class='line'>329</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l329s0' title='Executions: 0' class='uncovered'>if (bsnEntId == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>330</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l330s0'>                throw new SandataRuntimeException("BusinessEntityID (bsn_ent_id) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>331</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>333</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l333s0'>            String lastName = (String) mcl.get(0);</pre></td>
    </tr>
    <tr>
      <td class='line'>334</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l334s0'>            String firstName = (String) mcl.get(1);</pre></td>
    </tr>
    <tr>
      <td class='line'>335</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l335s0'>            String userName = (String) mcl.get(2);</pre></td>
    </tr>
    <tr>
      <td class='line'>336</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l336s0'>            String roleName = (String) mcl.get(3);</pre></td>
    </tr>
    <tr>
      <td class='line'>337</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l337s0'>            int page = (int) mcl.get(4);</pre></td>
    </tr>
    <tr>
      <td class='line'>338</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l338s0'>            int pageSize = (int) mcl.get(5);</pre></td>
    </tr>
    <tr>
      <td class='line'>339</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l339s0'>            String sortOn = (String) mcl.get(6);</pre></td>
    </tr>
    <tr>
      <td class='line'>340</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l340s0'>            String sortDirection = (String) mcl.get(7);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>342</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l342s0'>            Response response = restDataService.findUser(bsnEntId, lastName, firstName, userName, roleName, page,</pre></td>
    </tr>
    <tr>
      <td class='line'>343</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                pageSize, sortOn, sortDirection);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>345</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l345s0'>            response.setStatus(ServiceStatus.SUCCESS);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>347</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l347s0'>            exchange.getIn().setBody(response);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>349</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l349s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>350</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l350s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>351</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l351s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>352</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        } finally {</pre></td>
    </tr>
    <tr>
      <td class='line'>353</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l353s0'>            logger.stop();</pre></td>
    </tr>
    <tr>
      <td class='line'>354</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l354s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>355</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l355s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>357</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void insertUpdateRole(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr>
      <td class='line'>358</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>360</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l360s0'>            ApplicationRoleExt applicationRoleExt = (ApplicationRoleExt) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>362</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l362s0'>            int result = restDataService.insertRoleUpdate(applicationRoleExt);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>364</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l364s0'>            exchange.getIn().setBody(result);</pre></td>
    </tr>
    <tr>
      <td class='line'>365</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l365s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>366</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l366s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>367</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l367s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>368</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l368s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>369</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l369s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>372</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void getRole(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr>
      <td class='line'>373</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>375</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l375s0'>            MessageContentsList mcl = (MessageContentsList) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr>
      <td class='line'>376</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l376s0'>            int roleSk = (int) mcl.get(0);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>378</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l378s0'>            ApplicationRoleExt result = restDataService.getRole(roleSk);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>380</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l380s0'>            exchange.getIn().setBody(result);</pre></td>
    </tr>
    <tr>
      <td class='line'>381</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l381s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>382</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l382s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>383</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l383s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>384</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l384s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>385</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l385s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>388</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void getApplicationModules(Exchange exchange) {</pre></td>
    </tr>
    <tr>
      <td class='line'>389</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr>
      <td class='line'>390</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l390s0'>            List&lt;ApplicationModule> applicationModuleList = restDataService.getApplicationModules();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>392</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l392s0'>            exchange.getIn().setBody(applicationModuleList);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>394</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l394s0'>        } catch (Exception e) {</pre></td>
    </tr>
    <tr>
      <td class='line'>395</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l395s0'>            e.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>396</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l396s0'>            throw new SandataRuntimeException(e.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>397</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l397s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>398</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l398s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>400</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void getSecureGroups(Exchange exchange) {</pre></td>
    </tr>
    <tr>
      <td class='line'>401</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr>
      <td class='line'>402</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l402s0'>            List&lt;ApplicationSecureGroup> applicationSecureGroupList = restDataService.getApplicationSecureGroups();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>404</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l404s0'>            exchange.getIn().setBody(applicationSecureGroupList);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>406</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l406s0'>        } catch (Exception e) {</pre></td>
    </tr>
    <tr>
      <td class='line'>407</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l407s0'>            e.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>408</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l408s0'>            throw new SandataRuntimeException(e.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>409</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l409s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>410</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l410s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>412</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void getRoles(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr>
      <td class='line'>413</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>415</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l415s0'>            String businessEntityId = (String) exchange.getIn().getHeader("bsn_ent_id");</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>417</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l417s0' title='Executions: 0' class='uncovered'>if (businessEntityId == null)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>418</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l418s0'>                throw new SandataRuntimeException("BusinessEntityID (bsn_ent_id) is required!");</pre></td>
    </tr>
    <tr>
      <td class='line'>419</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>421</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l421s0'>            List&lt;ApplicationRoleExt> result = restDataService.getRoles(businessEntityId);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>423</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l423s0'>            exchange.getIn().setBody(result);</pre></td>
    </tr>
    <tr>
      <td class='line'>424</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l424s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>425</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l425s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>426</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l426s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>427</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l427s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>428</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l428s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>430</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void getToken(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr>
      <td class='line'>431</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>433</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l433s0'>            byte[] userHashBase64 = (byte[]) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>435</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l435s0' title='Executions: 0' class='uncovered'>if (userHashBase64 != null</span> && <span id='l435s1' title='Executions: 0' class='uncovered'>userHashBase64.length > 0)</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>437</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l437s0'>                String[] authenticationHashArray = getUserPassHash(userHashBase64);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>439</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>                <span id='l439s0' title='Executions: 0' class='uncovered'>if (authenticationHashArray.length == 2)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>440</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l440s0'>                    AccessToken accessToken = openAMService.tokenRequest(authenticationHashArray[0], authenticationHashArray[1]);</pre></td>
    </tr>
    <tr>
      <td class='line'>441</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l441s0'>                    exchange.getIn().setBody(accessToken);</pre></td>
    </tr>
    <tr>
      <td class='line'>442</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                }</pre></td>
    </tr>
    <tr>
      <td class='line'>443</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr>
      <td class='line'>444</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l444s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>445</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l445s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>446</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l446s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>447</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l447s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>448</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l448s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>450</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void refreshToken(Exchange exchange) {</pre></td>
    </tr>
    <tr>
      <td class='line'>451</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>453</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l453s0'>            String token = (String) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>455</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l455s0'>            AccessToken accessToken = openAMService.refreshToken(token);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>457</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l457s0'>            exchange.getIn().setBody(accessToken.getRefreshToken());</pre></td>
    </tr>
    <tr>
      <td class='line'>458</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l458s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>459</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l459s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>460</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l460s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>461</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l461s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>462</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l462s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>464</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void resetPassword(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>466</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l466s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>468</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>470</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l470s0'>            String userName = (String) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>472</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l472s0'>            String tempPassword = newPassword();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>474</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l474s0'>            idmService.changePassword(userName, tempPassword);</pre></td>
    </tr>
    <tr>
      <td class='line'>475</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l475s0'>            String message = "Your temporary password is " + tempPassword + ". Please login and change, 8 char min length one capital and one number required.";</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>478</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l478s0'>            idmService.emailUser(userName, "no-reply@sandata", "text/html", "Password Reset", message);</pre></td>
    </tr>
    <tr>
      <td class='line'>479</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l479s0'>            logger.info(String.format("Successfully sent email user to user: %s", userName));</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>482</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l482s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>483</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l483s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>484</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l484s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>485</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l485s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>486</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l486s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>488</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void emailUser(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr>
      <td class='line'>489</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l489s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>491</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>493</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l493s0'>            String userName = (String) exchange.getIn().getHeader("user_name");</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>496</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l496s0'>            Email email = (Email) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr>
      <td class='line'>497</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l497s0'>            idmService.emailUser(userName, "no-reply@sandata.com", email.getType(), email.getSubject(), email.getBody());</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>499</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l499s0'>            logger.info(String.format("Email sent to user: %s", userName));</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>501</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l501s0'>            exchange.getIn().setBody(true);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>503</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l503s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>504</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l504s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>505</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l505s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>506</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        } finally {</pre></td>
    </tr>
    <tr>
      <td class='line'>507</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l507s0'>            logger.stop();</pre></td>
    </tr>
    <tr>
      <td class='line'>508</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l508s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>509</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l509s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>511</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    public void changePassword(Exchange exchange) throws Exception {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>513</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l513s0'>        SandataLogger logger = AuthenticationLogger.CreateLogger();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>515</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        try {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>517</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l517s0'>            byte[] userHashBase64 = (byte[]) exchange.getIn().getBody();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>519</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>            <span id='l519s0' title='Executions: 0' class='uncovered'>if (userHashBase64 != null</span> && <span id='l519s1' title='Executions: 0' class='uncovered'>userHashBase64.length > 0)</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>521</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l521s0'>                String[] authenticationHashArray = getUserPassHash(userHashBase64);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>523</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>                <span id='l523s0' title='Executions: 0' class='uncovered'>if (authenticationHashArray.length == 2)</span> {</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>525</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l525s0'>                    idmService.changePassword(authenticationHashArray[0], authenticationHashArray[1]);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>527</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l527s0'>                    logger.info(String.format("Successfully changed password for user: %s", authenticationHashArray[0]));</pre></td>
    </tr>
    <tr>
      <td class='line'>528</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                } else {</pre></td>
    </tr>
    <tr>
      <td class='line'>529</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l529s0'>                    throw new SandataRuntimeException("Invalid format for username and password");</pre></td>
    </tr>
    <tr>
      <td class='line'>530</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                }</pre></td>
    </tr>
    <tr>
      <td class='line'>531</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l531s0'>            } else {</pre></td>
    </tr>
    <tr>
      <td class='line'>532</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l532s0'>                throw new SandataRuntimeException("Invalid format for username and password");</pre></td>
    </tr>
    <tr>
      <td class='line'>533</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            }</pre></td>
    </tr>
    <tr>
      <td class='line'>534</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l534s0'>        } catch (Exception ex) {</pre></td>
    </tr>
    <tr>
      <td class='line'>535</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l535s0'>            ex.printStackTrace();</pre></td>
    </tr>
    <tr>
      <td class='line'>536</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l536s0'>            throw new SandataRuntimeException(ex.getMessage());</pre></td>
    </tr>
    <tr>
      <td class='line'>537</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        } finally {</pre></td>
    </tr>
    <tr>
      <td class='line'>538</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l538s0'>            logger.stop();</pre></td>
    </tr>
    <tr>
      <td class='line'>539</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l539s0'>        }</pre></td>
    </tr>
    <tr>
      <td class='line'>540</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l540s0'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>542</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private String newPassword() {</pre></td>
    </tr>
    <tr>
      <td class='line'>543</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l543s0'>        SecureRandom random = new SecureRandom();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>545</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l545s0'>        int passwordLength = random.nextInt(maxPasswordLength - minPassWordLength) + minPassWordLength;</pre></td>
    </tr>
    <tr>
      <td class='line'>546</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l546s0'>        int availableChars = passwordLength;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>548</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l548s0'>        int specialLength = 1;</pre></td>
    </tr>
    <tr>
      <td class='line'>549</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l549s0'>        int numericsLength = 1;</pre></td>
    </tr>
    <tr>
      <td class='line'>550</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l550s0'>        availableChars -= (specialLength - numericsLength);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>552</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l552s0'>        int lowerCaseLength = (passwordLength - specialLength - numericsLength) / 2;</pre></td>
    </tr>
    <tr>
      <td class='line'>553</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l553s0'>        availableChars -= lowerCaseLength;</pre></td>
    </tr>
    <tr>
      <td class='line'>554</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l554s0'>        int upperCaseLength = availableChars;</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>556</td><td>&nbsp;</td>
      <td><pre class='comment'>        //Generate a new password with the require character lengths</pre></td>
    </tr>
    <tr>
      <td class='line'>557</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l557s0'>        return generatePassword(lowerCaseLength, upperCaseLength, numericsLength, specialLength);</pre></td>
    </tr>
    <tr>
      <td class='line'>558</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>560</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private String generateGUID() {</pre></td>
    </tr>
    <tr>
      <td class='line'>561</td><td class='count'>1</td>
      <td><pre class='prettyprint covered' id='l561s0'>        return UUID.randomUUID().toString();</pre></td>
    </tr>
    <tr>
      <td class='line'>562</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>564</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private String generatePassword(int lowerCaseLength, int upperCaseLength, int numericsLength,</pre></td>
    </tr>
    <tr>
      <td class='line'>565</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                                    int specialCharactersLength) {</pre></td>
    </tr>
    <tr>
      <td class='line'>566</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l566s0'>        String upperCaseChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";</pre></td>
    </tr>
    <tr>
      <td class='line'>567</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l567s0'>        String lowerCaseChars = "abcdefghijklmnopqrstuvwxyz";</pre></td>
    </tr>
    <tr>
      <td class='line'>568</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l568s0'>        String numericChars = "0123456789";</pre></td>
    </tr>
    <tr>
      <td class='line'>569</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l569s0'>        String specialChars = "~`!@#$%^&*()-_=+[{]}\\|;:,&lt;.>/?";</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>571</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l571s0'>        SecureRandom secureRandom = new SecureRandom();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>573</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l573s0'>        List&lt;String> passwordSubString = new ArrayList&lt;>();</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>576</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l576s0'>        passwordSubString.add(</pre></td>
    </tr>
    <tr>
      <td class='line'>577</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            RandomStringUtils.random(upperCaseLength, 0, 0, false, false,</pre></td>
    </tr>
    <tr>
      <td class='line'>578</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                upperCaseChars.toCharArray(), secureRandom)</pre></td>
    </tr>
    <tr>
      <td class='line'>579</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        );</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>581</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l581s0'>        passwordSubString.add(</pre></td>
    </tr>
    <tr>
      <td class='line'>582</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            RandomStringUtils.random(lowerCaseLength, 0, 0, false, false,</pre></td>
    </tr>
    <tr>
      <td class='line'>583</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                lowerCaseChars.toCharArray(), secureRandom)</pre></td>
    </tr>
    <tr>
      <td class='line'>584</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        );</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>586</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l586s0'>        passwordSubString.add(</pre></td>
    </tr>
    <tr>
      <td class='line'>587</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            RandomStringUtils.random(numericsLength, 0, 0, false, false,</pre></td>
    </tr>
    <tr>
      <td class='line'>588</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                numericChars.toCharArray(), secureRandom)</pre></td>
    </tr>
    <tr>
      <td class='line'>589</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        );</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>591</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l591s0'>        passwordSubString.add(</pre></td>
    </tr>
    <tr>
      <td class='line'>592</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>            RandomStringUtils.random(specialCharactersLength, 0, 0, false, false,</pre></td>
    </tr>
    <tr>
      <td class='line'>593</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>                specialChars.toCharArray(), secureRandom)</pre></td>
    </tr>
    <tr>
      <td class='line'>594</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        );</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>596</td><td>&nbsp;</td>
      <td><pre class='comment'>        //Create password string</pre></td>
    </tr>
    <tr>
      <td class='line'>597</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l597s0'>        StringBuilder stringBuilder = new StringBuilder();</pre></td>
    </tr>
    <tr>
      <td class='line'>598</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>        <span id='l598s0' title='Executions: 0' class='uncovered'>for (String s</span> : <span id='l598s1' title='Executions: 0' class='uncovered'>passwordSubString)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>599</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l599s0'>            stringBuilder.append(s);</pre></td>
    </tr>
    <tr>
      <td class='line'>600</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l600s0'>        }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>602</td><td>&nbsp;</td>
      <td><pre class='comment'>        //Split password String to List</pre></td>
    </tr>
    <tr>
      <td class='line'>603</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l603s0'>        List&lt;Character> characters = new ArrayList&lt;Character>();</pre></td>
    </tr>
    <tr>
      <td class='line'>604</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>        <span id='l604s0' title='Executions: 0' class='uncovered'>for (char c</span> : <span id='l604s1' title='Executions: 0' class='uncovered'>stringBuilder.toString().toCharArray())</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>605</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l605s0'>            characters.add(c);</pre></td>
    </tr>
    <tr>
      <td class='line'>606</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>        }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>608</td><td>&nbsp;</td>
      <td><pre class='comment'>        //Shuffle the order of elements in the array</pre></td>
    </tr>
    <tr>
      <td class='line'>609</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l609s0'>        Collections.shuffle(characters);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>611</td><td>&nbsp;</td>
      <td><pre class='comment'>        //Recreate password string</pre></td>
    </tr>
    <tr>
      <td class='line'>612</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l612s0'>        StringBuilder stringBuilder2 = new StringBuilder();</pre></td>
    </tr>
    <tr>
      <td class='line'>613</td><td class='count'>0</td>
      <td><pre class='prettyprint jmp'>        <span id='l613s0' title='Executions: 0' class='uncovered'>for (Character s</span> : <span id='l613s1' title='Executions: 0' class='uncovered'>characters)</span> {</pre></td>
    </tr>
    <tr>
      <td class='line'>614</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l614s0'>            stringBuilder2.append(s);</pre></td>
    </tr>
    <tr>
      <td class='line'>615</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l615s0'>        }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>617</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l617s0'>        return stringBuilder2.toString();</pre></td>
    </tr>
    <tr>
      <td class='line'>618</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    }</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>620</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    private String[] getUserPassHash(byte[] hash) {</pre></td>
    </tr>
    <tr>
      <td class='line'>621</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l621s0'>        String authenticationHash = new String(Base64.decodeBase64(hash), StandardCharsets.UTF_8);</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>623</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l623s0'>        String[] authenticationHashArray = authenticationHash.split(":");</pre></td>
    </tr>
    <tr><td class='line'></td><td colspan='2'>&nbsp;</td></tr>
    <tr>
      <td class='line'>625</td><td class='count'>0</td>
      <td><pre class='prettyprint uncovered' id='l625s0'>        return authenticationHashArray;</pre></td>
    </tr>
    <tr>
      <td class='line'>626</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>    }</pre></td>
    </tr>
    <tr>
      <td class='line'>627</td><td>&nbsp;</td>
      <td><pre class='prettyprint'>}</pre></td>
    </tr>
  </table>
</body>
</html>
